# Perusrunko ja pÃ¤Ã¤toiminnallisuudet

TÃ¤ssÃ¤ vaiheessa aloitetaan sovelluksen kehitys ja dokumentoidaan etenemistÃ¤ vaiheittain tÃ¤hÃ¤n dokumenttiin. 

## 2.1. YmpÃ¤ristÃ¶ ##

TÃ¤ssÃ¤ luvussa kuvaillaan kÃ¤ytetty kehitysympÃ¤ristÃ¶ ja projektissa tarvittavien ohjelmien asennus. 
Projekti kehitetÃ¤Ã¤n aluksi omalla paikallisella koneella VSCodella ja siirretÃ¤Ã¤n Azuren pilvipalveluun myÃ¶hemmin, kun backend ja frontend ovat perusrakeenteeltaan valmiit.
Projektin kehittÃ¤misessÃ¤ tarvitaan seuraavia ohjelmia: 
  - Node.js (+express) - Backendin ja frontendin ajamiseen
  - SQLite3 - Tietokanta
  - Git & GitHub - Versionhallintaan
  - VS Code - Koodieditori

  **Node.js** 

Node.js tarvitaan projektissa JavaScriptin ajamiseen ja se on tÃ¤mÃ¤n projektin backendin ja frontendin pÃ¤Ã¤ajoympÃ¤ristÃ¶. 
    - Asennetaan Node.js virallisilta sivuilta: https://nodejs.org/en
    - Ladattiin uusin versio (LTS) ja asennettiin oletusasetuksilla. 
    - Tarkistetaan asennus komentorivin kautta: node -v ja tarkistetaan, ettÃ¤ komento palauttaa versionumeron.

  **SQLite**

PÃ¤Ã¤dyimme kÃ¤yttÃ¤mÃ¤Ã¤n tietokannassa SQLiteÃ¤, koska meillÃ¤ on pieni kahden hengen kehitystiimi ja tyÃ¶skentelemme pÃ¤Ã¤osin etÃ¤nÃ¤ omilla koneillamme.
Valitsemalla SQLiten varmistamme, ettÃ¤ molemmat tiimin jÃ¤senet pÃ¤Ã¤sevÃ¤t helposti kÃ¤siksi yhteiseen tietokantaan. 
Emme odota suuria kÃ¤yttÃ¤jÃ¤- tai tietomÃ¤Ã¤riÃ¤, joten emme tarvitse monimutkaista tietokantarakennetta projektin kehityksen tÃ¤ssÃ¤ vaiheessa.  

  - Asennettaan SQLite nettisivujen kautta: https://www.sqlite.org/download.html
  - Ladattiin ja asennettiin Windowsin versio sqlite-dll-win-x64-3490100.zip (64-bit DLL)
  - Tarkistetaan asennus komentorivin kautta: sqlite3 --version ja tarkistetaan, ettÃ¤ komento palauttaa versionumeron.

**GitHub ja VSCode**

KÃ¤ytÃ¤mme projektin versionhallintaan yhteistÃ¤ GitHub repositorya ja sovelluksen koodaamiseen VSCodea. Tiimin jÃ¤senet pÃ¤ivittÃ¤vÃ¤t koodiin tehdyt muutokset GitHubiin, josta
muut jÃ¤senet voivat hakea muutokset omaan kehitysympÃ¤ristÃ¶Ã¶nsÃ¤ ja nÃ¤in molempien koodi pysyy samassa vaiheessa. 

  - GitHub repon osoite: https://github.com/TaipaleMari/Web-kehitys-Projekti
  - kloonataan komennolla: git clone https://github.com/TaipaleMari/Web-kehitys-Projekti.git
  - siirrytÃ¤Ã¤n VSCodessa kloonattuun kansioon ja aloitetaan projektin koodin luominen.

*Edit* 15.4.2025 Siirto Azuren pilvipalvelimeen. Kloonattu tÃ¤mÃ¤n github-repossa master-haarassa sijaitseva sovellus. Sovellus on Azuressa kÃ¤ynnissÃ¤ ja saa pÃ¤ivitykset (kts. alta kuvat). Sovelluksen pitÃ¤isi toimia osoitteessa: noma-react-app-exc6fsdmejc2eydy.westeurope-01.azurewebsites.net 
Ongelmia vielÃ¤ toistaiseksi koodissa, koska sovellus ei kÃ¤ynnisty selaimessa oikein. 

![Sovellus_kÃ¤ynnissÃ¤](../Screenshot 2025-04-15 145155.png)

![Sovelluksen_tiedot](../Screenshot 2025-04-15 145216.png)

## 2.2. Backend ##

TÃ¤ssÃ¤ luvussa on kuvattu backend kehityksen vaiheet VSCodessa. Lopuksi sovelluksen koodi on siirretty tÃ¤hÃ¤n GitHub projektirepoon, master-haaraan: https://github.com/TaipaleMari/Web-kehitys-Projekti.git  

Sovelluskansion sisÃ¤Ã¤n luotu erillinen backend kansio.  VSCoden terminaalissa on navigoitu backend kansioon ja alustetaan uusi Node.js-projekti oletusasetuksilla: ```npm init -y``` 

Asensimme kerralla tarvittavat npm paketit: ```install express sqlite3 bkryptjs jsonwebtoken cors dotenv```
- express = Noden web-sovelluskehys
- sqlite3 = tietokantakÃ¤yttÃ¶ Nodessa
- bcryptjs = salasanojen turvalliseen kÃ¤yttÃ¶Ã¶n salausfunktiot
- jsonwebtoken = autentikointia varten
- cors = Cross-Origin Resource Sharing -tuki (sallitaan ulkopuolisten verkkosivujen tehdÃ¤ pyyntÃ¶jÃ¤)
- dotenv = lataa ympÃ¤ristÃ¶muuttujia .env-tiedostosta


Backend-kansioon luotu server.js tiedosto ja tiedostoon lisÃ¤tty koodi, joka sisÃ¤ltÃ¤Ã¤ rekisterÃ¶intireitin, testireitin, kÃ¤yttÃ¤jÃ¤tietokannan, kirjautumisreitin (sisÃ¤ltÃ¤Ã¤ viestin jos salasana tai kÃ¤yttÃ¤nimi virheellinen) sekÃ¤ palvelimen kÃ¤ynnistys (kuuntelee porttia 5000;)

[server.js](https://github.com/TaipaleMari/Web-kehitys-Projekti/blob/master/backend/server.js)

Terminaaliin komento ```node server.js```, selaimella http://localhost:5000/ , saatu viesti selaimeen "backend toimii!"

Backend kansioon luotiin database-kansio ja sen sisÃ¤Ã¤n sqliten tietokanta tiedosto: database/users.db.
Backend kansioon tehtiin db.js -tiedosto, joka sisÃ¤ltÃ¤Ã¤ tietokantayhteyden server.js tiedostoon. TÃ¤mÃ¤n jÃ¤lkeen kÃ¤ynnistettiin palvelin uudelleen testataksemme tietokantayhteyden toimivuuden, tarkoituksena saada terminaaliin viesti "yhdistetty sqlite tietokantaan".

KÃ¤yttÃ¤jÃ¤n rekisterÃ¶inti: lisÃ¤tty koodia server.js:n, joka mahdollistaa kÃ¤yttÃ¤jÃ¤n rekisterÃ¶imisen. Testattu komentoriviltÃ¤ rekisterÃ¶intiÃ¤: cURL-komennolla: ```curl -X POST http://localhost:5000/register \
    -H "Content-Type: application/json" \
    -d '{"username": "testuser", "email": "testuser@example.com", "password": "password123"}'```


## 2.3. Frontend ##

FrontendissÃ¤ haluamme kÃ¤yttÃ¤jÃ¤lle seuraavat toiminnallisuudet:
  - etusivulla sisÃ¤Ã¤nkirjautuminen ja linkki rekisterÃ¶itymislomakkeelle
  - onnistuneen kirjautumisen jÃ¤lkeen siirrytÃ¤Ã¤n kÃ¤yttÃ¤jÃ¤n omalle etusivulle, jossa listaus tehtÃ¤vistÃ¤
  - tehtÃ¤vien merkkaaminen suoritetuksi, tehtÃ¤vien muokkaaminen ja lisÃ¤Ã¤minen

Frontend kansioon tehtiin register.js-tiedosto ja app.js-tiedosto. 

Terminaalissa annettiin komento: ```react-router-dom``` , joka lataa ja asentaa React-kirjaston. TÃ¤mÃ¤ mahdollistaa sovelluksen eri sivujen navigoinnin ilman, ettÃ¤ koko sivu latautuu uudelleen.... tekee sovelluksestamme dynaamisemman kÃ¤yttÃ¤Ã¤. tarvitsemme tÃ¤tÃ¤ ominaisuutta, jotta kÃ¤yttÃ¤jÃ¤ voi joustavasti muokata omaa tehtÃ¤vÃ¤tauluaan. 

Sovelluksen kÃ¤ynnistyessÃ¤ ensin aukeaa Home.js sivu, josta voi valita siirtymisen edelleen kirjautumiseen (login.js) tai rekisterÃ¶itymiseen (register.js)

### RekisterÃ¶inti ###

[Register.js:n koodi](https://github.com/TaipaleMari/Web-kehitys-Projekti/blob/master/frontend/src/pages/Register.js)


### Kirjautuminen ###

Login.js ja yhteys backendiin, jossa varmistetaan, ettÃ¤ kÃ¤ttÃ¤jÃ¤ on rekisterÃ¶itynyt ja ettÃ¤ salasana tÃ¤smÃ¤Ã¤ kÃ¤yttÃ¤jÃ¤tunnuksen kanssa. 

[Login.js:n koodi ](https://github.com/TaipaleMari/Web-kehitys-Projekti/blob/master/frontend/src/pages/Login.js)

### KÃ¤yttÃ¤jÃ¤n sivu ### 

local storage - koodirivi userDashboard.js:ssÃ¤ ja App.js:ssÃ¤ mahdollistaa kÃ¤yttÃ¶tietojen sÃ¤ilyttÃ¤misen selaimessa. 

userDashboard.js sisÃ¤ltÃ¤Ã¤ kÃ¤yttÃ¤jÃ¤n etusivun ja tehtÃ¤vien muokkauksen

[userDashboard.js:n koodi](https://github.com/TaipaleMari/Web-kehitys-Projekti/blob/master/frontend/src/pages/UserDashboard.js)


## 2.4. Tietokanta ##

Tietokantana sovelluksella toimii SQLite. Se on kevyt ja helppokÃ¤yttÃ¶inen ratkaisu paikalliseen kehitykseen. Tietokantaan kÃ¤yttÃ¤jille luodaan taulu, jossa on seuraavat kentÃ¤t:
  - id INTEGER PRIMARY KEY
  - username TEXT UNIQUE
  - email TEXT UNIQUE
  - password TEXT

Tietokantaan voidaan laajentaa lisÃ¤kenttiÃ¤, kuten tehtÃ¤vÃ¤t ja aikaleimat.
Tietokanta alustetaan automaattisesti db.js-tiedoston kautta, joka yhdistetÃ¤Ã¤n backendiin server.js:n.

## 2.5. Perusrakenne ja arkkitehtuuri ##

Backend koostuu: 
  - server.js, joka on sovelluksen pÃ¤Ã¤asiallinen palvelintiedosto. TÃ¤mÃ¤ mÃ¤Ã¤rittelee reitit ja kÃ¤sittelee HTTP-pyynnÃ¶t
  - db.js, joka on tietokannan alustamiseen ja taulujen luontiin
  - routes/ , tÃ¤mÃ¤ on tulevia reittejÃ¤ varten
  

Frontend koostuu:
   - App.js, tÃ¤mÃ¤ on pÃ¤Ã¤komponentti ja sisÃ¤ltÃ¤Ã¤ reititykset
   - pages/, nÃ¤issÃ¤ on rekisterÃ¶inti, kirjautuminen, etusivu jne.

Sovelluksen kansiorakenne:


```text
ğŸ“ Master-haara
â”œâ”€â”€ ğŸ“ backend
â”œâ”€â”€ ğŸ“ database
â”œâ”€â”€ ğŸ“ node_modules
â”œâ”€â”€ ğŸ“ frontend
â”‚   â”œâ”€â”€ ğŸ“ public
â”‚   â””â”€â”€ ğŸ“ src
â”‚       â”œâ”€â”€ ğŸ“ pages
â”‚       â”‚   â”œâ”€â”€ AddTasksForm.js
â”‚       â”‚   â”œâ”€â”€ Home.js
â”‚       â”‚   â”œâ”€â”€ Login.js
â”‚       â”‚   â””â”€â”€ Register.js
â”‚       â”œâ”€â”€ UserDashboard.js
â”‚       â”œâ”€â”€ App.js
â”‚       â””â”€â”€ App.css
â””â”€â”€ README.md
```






## 2.6. Toiminnot ##

Sovelluskehityksen tÃ¤ssÃ¤ vaiheessa olemme toteuttaneet seuraavat toiminnallisuudet: 
  - KÃ¤yttÃ¤jÃ¤n rekisterÃ¶inti ja kirjautuminen
  - JWT-autentikointi backendissÃ¤
  - KÃ¤yttÃ¤jÃ¤n tehtÃ¤vien hallinta: lisÃ¤Ã¤minen, muokkaaminen ja suoritetuksi merkkaaminen
  - LocalStorageen tallentaminen

NÃ¤mÃ¤ toiminnallisuudet on testattu ja ne toimivat odotetulla tavalla. Frontendin ja backendin vÃ¤linen yhteys toimii JSON-pyyntÃ¶jen avulla. 

## 2.7. Testaus ja virheenkÃ¤sittely ##

VirheenkÃ¤sittely on toteutettu backendiin tarkistamalla 
1. onko kÃ¤yttÃ¤jÃ¤ olemassa
2. tÃ¤smÃ¤Ã¤kÃ¶ salasana
3. ovatko syÃ¶tetyt kentÃ¤t tyhjiÃ¤

FrontendissÃ¤ virheviestit ilmestyvÃ¤t kÃ¤yttÃ¤jÃ¤lle nÃ¤kyviin.
Testausta on suoritettu manuaalisesti selaimen kautta testaamalla, ettÃ¤ toiminnot toimivat kuten pitÃ¤Ã¤ sekÃ¤ komentorivin kautta cURL:illa. 

JEST TAI CYPRESS KIRJASTOT JOS KERITÃ„Ã„N TEHDÃ„

## 2.8. KÃ¤yttÃ¶liittymÃ¤ ja vuorovaikutus ##

KÃ¤yttÃ¶liittymÃ¤ on rakennettu Reactilla. 
